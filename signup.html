<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <meta name="description" content="Create your SPORTIQ account - Join the ultimate global sports platform">
    <meta name="keywords" content="SPORTIQ, Signup, Registration, Sports Platform">
    <meta name="robots" content="noindex, nofollow">

    <title>Sign Up - SPORTIQ</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/layer71-auth.css">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/icons/favicon.ico">
</head>

<body>
    <div class="auth-container">
        <div class="auth-box">
            <div class="auth-header">
                <div class="auth-logo">⚽</div>
                <h1 class="auth-title">Create Account</h1>
                <p class="auth-subtitle">Join SPORTIQ and start your journey</p>
            </div>

            <!-- Alert Container -->
            <div id="alertContainer"></div>

            <!-- Signup Form -->
            <form id="signupForm" class="auth-form">
                <div class="form-group">
                    <label for="username" class="form-label">Username</label>
                    <input type="text" id="username" name="username" class="form-input" placeholder="Choose a username"
                        required autocomplete="username" minlength="3" maxlength="20" pattern="[a-zA-Z0-9_]+"
                        title="Username must contain only letters, numbers, and underscores">
                    <span class="form-error">Username must be 3-20 characters (letters, numbers, _ only)</span>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" id="email" name="email" class="form-input" placeholder="Enter your email"
                        required autocomplete="email">
                    <span class="form-error">Please enter a valid email address</span>
                </div>

                <div class="form-group">
                    <label for="firstName" class="form-label">First Name</label>
                    <input type="text" id="firstName" name="firstName" class="form-input"
                        placeholder="Enter your first name" autocomplete="given-name">
                </div>

                <div class="form-group">
                    <label for="lastName" class="form-label">Last Name</label>
                    <input type="text" id="lastName" name="lastName" class="form-input"
                        placeholder="Enter your last name" autocomplete="family-name">
                </div>

                <div class="form-group">
                    <label for="password" class="form-label">Password</label>
                    <input type="password" id="password" name="password" class="form-input"
                        placeholder="Create a strong password" required autocomplete="new-password" minlength="8">
                    <span class="form-error" id="passwordError">Password must meet security requirements</span>

                    <!-- Password strength indicator -->
                    <div id="passwordStrength" style="margin-top: 0.5rem; display: none;">
                        <div style="display: flex; gap: 0.25rem; margin-bottom: 0.25rem;">
                            <div class="strength-bar"
                                style="flex: 1; height: 4px; background: #e5e7eb; border-radius: 2px;"></div>
                            <div class="strength-bar"
                                style="flex: 1; height: 4px; background: #e5e7eb; border-radius: 2px;"></div>
                            <div class="strength-bar"
                                style="flex: 1; height: 4px; background: #e5e7eb; border-radius: 2px;"></div>
                            <div class="strength-bar"
                                style="flex: 1; height: 4px; background: #e5e7eb; border-radius: 2px;"></div>
                        </div>
                        <div id="passwordStrengthText" style="font-size: 0.75rem; color: #6b7280;"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword" class="form-label">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" class="form-input"
                        placeholder="Re-enter your password" required autocomplete="new-password">
                    <span class="form-error">Passwords do not match</span>
                </div>

                <div class="form-group">
                    <div class="form-checkbox">
                        <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                        <label for="agreeTerms">I agree to the <a href="#" class="auth-link">Terms of Service</a> and <a
                                href="#" class="auth-link">Privacy Policy</a></label>
                    </div>
                </div>

                <button type="submit" class="auth-submit" id="signupBtn">
                    <span class="btn-text">Create Account</span>
                    <span class="auth-loading" style="display: none;"></span>
                </button>
            </form>

            <!-- Links -->
            <div class="auth-links">
                <p>
                    Already have an account?
                    <a href="login.html" class="auth-link">Login</a>
                </p>
                <p style="margin-top: 1rem;">
                    <a href="index.html" class="auth-link">← Back to Home</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/layer71-auth-engine.js"></script>

    <script>
        // Password strength checker
        document.getElementById('password').addEventListener('input', function () {
            const password = this.value;
            const strengthDiv = document.getElementById('passwordStrength');
            const bars = strengthDiv.querySelectorAll('.strength-bar');
            const text = document.getElementById('passwordStrengthText');

            if (password.length === 0) {
                strengthDiv.style.display = 'none';
                return;
            }

            strengthDiv.style.display = 'block';

            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength++;

            const colors = ['#ef4444', '#f59e0b', '#10b981', '#059669'];
            const labels = ['Weak', 'Fair', 'Good', 'Strong'];

            bars.forEach((bar, index) => {
                if (index < Math.floor(strength * 0.8)) {
                    bar.style.background = colors[Math.min(Math.floor(strength * 0.8) - 1, 3)];
                } else {
                    bar.style.background = '#e5e7eb';
                }
            });

            text.textContent = `Strength: ${labels[Math.min(Math.floor(strength * 0.8) - 1, 3)] || 'Very Weak'}`;
            text.style.color = colors[Math.min(Math.floor(strength * 0.8) - 1, 3)] || '#ef4444';
        });

        // Confirm password matching
        document.getElementById('confirmPassword').addEventListener('input', function () {
            const password = document.getElementById('password').value;
            const confirmPassword = this.value;

            if (confirmPassword && password !== confirmPassword) {
                this.classList.add('error');
            } else {
                this.classList.remove('error');
            }
        });

        // Signup form handling
        document.getElementById('signupForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Validate password match
            if (password !== confirmPassword) {
                showAlert('Passwords do not match', 'error');
                return;
            }

            // Check terms agreement
            if (!document.getElementById('agreeTerms').checked) {
                showAlert('Please agree to the Terms of Service and Privacy Policy', 'error');
                return;
            }

            const userData = {
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: password,
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value
            };

            const signupBtn = document.getElementById('signupBtn');
            const btnText = signupBtn.querySelector('.btn-text');
            const loading = signupBtn.querySelector('.auth-loading');

            // Show loading
            signupBtn.disabled = true;
            btnText.style.display = 'none';
            loading.style.display = 'inline-block';

            try {
                const result = await window.AuthEngine.signup(userData);

                if (result.success) {
                    showAlert('Account created successfully! Logging you in...', 'success');

                    // Auto-login
                    setTimeout(async () => {
                        const loginResult = await window.AuthEngine.login(userData.username, userData.password);
                        if (loginResult.success) {
                            window.location.href = 'index.html';
                        }
                    }, 1000);
                } else {
                    showAlert(result.error, 'error');

                    // Reset button
                    signupBtn.disabled = false;
                    btnText.style.display = 'inline';
                    loading.style.display = 'none';
                }
            } catch (error) {
                showAlert('An error occurred. Please try again.', 'error');

                // Reset button
                signupBtn.disabled = false;
                btnText.style.display = 'inline';
                loading.style.display = 'none';
            }
        });

        function showAlert(message, type = 'info') {
            const container = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `auth-alert ${type}`;

            const icon = {
                success: '✅',
                error: '❌',
                warning: '⚠️',
                info: 'ℹ️'
            }[type] || 'ℹ️';

            alert.innerHTML = `<span>${icon}</span><div>${message}</div>`;
            container.innerHTML = '';
            container.appendChild(alert);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // Check if already logged in
        if (window.AuthEngine && window.AuthEngine.isAuthenticated()) {
            window.location.href = 'index.html';
        }
    </script>
</body>

</html>